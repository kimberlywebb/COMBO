<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Jointly estimate \(\beta\) and \(\gamma\) parameters from the true outcome
and observation mechanisms, respectively, in a binary outcome misclassification
model."><title>MCMC Estimation of the Binary Outcome Misclassification Model — COMBO_MCMC • COMBO</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MCMC Estimation of the Binary Outcome Misclassification Model — COMBO_MCMC"><meta property="og:description" content="Jointly estimate \(\beta\) and \(\gamma\) parameters from the true outcome
and observation mechanisms, respectively, in a binary outcome misclassification
model."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">COMBO</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/COMBO_notation_guide.html">COMBO Notation Guide</a>
    <a class="dropdown-item" href="../articles/COMBO_notation_guide_2stage.html">COMBO Notation Guide - Two-stage Misclassification Model</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>MCMC Estimation of the Binary Outcome Misclassification Model</h1>
      
      <div class="d-none name"><code>COMBO_MCMC.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Jointly estimate \(\beta\) and \(\gamma\) parameters from the true outcome
and observation mechanisms, respectively, in a binary outcome misclassification
model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">COMBO_MCMC</span><span class="op">(</span></span>
<span>  <span class="va">Ystar</span>,</span>
<span>  <span class="va">x_matrix</span>,</span>
<span>  <span class="va">z_matrix</span>,</span>
<span>  <span class="va">prior</span>,</span>
<span>  <span class="va">beta_prior_parameters</span>,</span>
<span>  <span class="va">gamma_prior_parameters</span>,</span>
<span>  number_MCMC_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  MCMC_sample <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  burn_in <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  display_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>Ystar</dt>
<dd><p>A numeric vector of indicator variables (1, 2) for the observed
outcome <code>Y*</code>. The reference category is 2.</p></dd>


<dt>x_matrix</dt>
<dd><p>A numeric matrix of covariates in the true outcome mechanism.
<code>x_matrix</code> should not contain an intercept.</p></dd>


<dt>z_matrix</dt>
<dd><p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept.</p></dd>


<dt>prior</dt>
<dd><p>A character string specifying the prior distribution for the
\(\beta\) and \(\gamma\) parameters. Options are <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code> (double Exponential, or Weibull).</p></dd>


<dt>beta_prior_parameters</dt>
<dd><p>A numeric list of prior distribution parameters
for the \(\beta\) terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain a matrix of location, lower bound, mean, or shape parameters,
respectively, for \(\beta\) terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain a matrix of shape, upper bound, standard deviation, or scale parameters,
respectively, for \(\beta\) terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
a matrix of the degrees of freedom for \(\beta\) terms.
The third list element should be empty for all other prior distributions.
All matrices in the list should have dimensions <code>n_cat</code> X <code>dim_x</code>, and all
elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p></dd>


<dt>gamma_prior_parameters</dt>
<dd><p>A numeric list of prior distribution parameters
for the \(\gamma\) terms. For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the first element of the
list should contain an array of location, lower bound, mean, or shape parameters,
respectively, for \(\gamma\) terms.
For prior distributions <code>"t"</code>,
<code>"uniform"</code>, <code>"normal"</code>, or <code>"dexp"</code>, the second element of the
list should contain an array of shape, upper bound, standard deviation, or scale parameters,
respectively, for \(\gamma\) terms.
For prior distribution <code>"t"</code>, the third element of the list should contain
an array of the degrees of freedom for \(\gamma\) terms.
The third list element should be empty for all other prior distributions.
All arrays in the list should have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>dim_z</code>,
and all elements in the <code>n_cat</code> row should be set to <code>NA</code>.</p></dd>


<dt>number_MCMC_chains</dt>
<dd><p>An integer specifying the number of MCMC chains to compute.
The default is <code>4</code>.</p></dd>


<dt>MCMC_sample</dt>
<dd><p>An integer specifying the number of MCMC samples to draw.
The default is <code>2000</code>.</p></dd>


<dt>burn_in</dt>
<dd><p>An integer specifying the number of MCMC samples to discard
for the burn-in period. The default is <code>1000</code>.</p></dd>


<dt>display_progress</dt>
<dd><p>A logical value specifying whether messages should be
displayed during model compilation. The default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>COMBO_MCMC</code> returns a list of the posterior samples and posterior
means for both the binary outcome misclassification model and a naive logistic
regression of the observed outcome, <code>Y*</code>, predicted by the matrix <code>x</code>.
The list contains the following components:</p>
<dl><dt>posterior_sample_df</dt>
<dd><p>A data frame containing three columns. The first
column indicates the chain from which a sample is taken, from 1 to <code>number_MCMC_chains</code>.
The second column specifies the parameter associated with a given row. \(\beta\)
terms have dimensions <code>dim_x</code> X <code>n_cat</code>. The \(\gamma\) terms
have dimensions <code>n_cat</code> X <code>n_cat</code> X <code>dim_z</code>, where the first
index specifies the observed outcome category and the second index specifies
the true outcome category. The final column provides the MCMC sample.</p></dd>

<dt>posterior_means_df</dt>
<dd><p>A data frame containing three columns. The first
column specifies the parameter associated with a given row. Parameters are
indexed as in the <code>posterior_sample_df</code>. The second column provides
the posterior mean computed across all chains and all samples. The final column
provides the posterior median computed across all chains and all samples.</p></dd>

<dt>naive_posterior_sample_df</dt>
<dd><p>A data frame containing three columns.
The first column indicates the chain from which a sample is taken, from
1 to <code>number_MCMC_chains</code>. The second column specifies the parameter
associated with a given row. Naive \(\beta\) terms have dimensions
<code>dim_x</code> X <code>n_cat</code>. The final column provides the MCMC sample.</p></dd>

<dt>naive_posterior_means_df</dt>
<dd><p>A data frame containing three columns. The first
column specifies the naive parameter associated with a given row. Parameters are
indexed as in the <code>naive_posterior_sample_df</code>. The second column provides
the posterior mean computed across all chains and all samples. The final column
provides the posterior median computed across all chains and all samples.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">x_mu</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">x_sigma</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">z_shape</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">true_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">.5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">x_mu</span>, <span class="va">x_sigma</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span>, <span class="va">x_matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">z_shape</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span>, <span class="va">z_matrix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">exp_xb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">true_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pi_result</span> <span class="op">=</span> <span class="va">exp_xb</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="va">exp_xb</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pi_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pi_result</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">pi_result</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">true_Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">true_Y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="va">pi_matrix</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">exp_zg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Z</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">true_gamma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pistar_denominator</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">exp_zg</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span> <span class="op">+</span> <span class="va">exp_zg</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pistar_result</span> <span class="op">=</span> <span class="va">exp_zg</span> <span class="op">/</span> <span class="va">pistar_denominator</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pistar_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pistar_result</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">pistar_result</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                         <span class="va">pistar_result</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">pistar_result</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">obs_Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">true_j</span> <span class="op">=</span> <span class="va">true_Y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">obs_Y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                     <span class="va">pistar_matrix</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">n</span> <span class="op">+</span> <span class="va">i</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     <span class="va">true_j</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Ystar</span> <span class="op">&lt;-</span> <span class="va">obs_Y</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">unif_lower_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">5</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">unif_upper_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">unif_lower_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="cn">NA</span>, <span class="op">-</span><span class="fl">5</span>, <span class="cn">NA</span>, <span class="op">-</span><span class="fl">5</span>, <span class="cn">NA</span>, <span class="op">-</span><span class="fl">5</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">unif_upper_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="cn">NA</span>, <span class="fl">5</span>, <span class="cn">NA</span>, <span class="fl">5</span>, <span class="cn">NA</span>, <span class="fl">5</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">beta_prior_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="va">unif_lower_beta</span>, upper <span class="op">=</span> <span class="va">unif_upper_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gamma_prior_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="va">unif_lower_gamma</span>, upper <span class="op">=</span> <span class="va">unif_upper_gamma</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">MCMC_results</span> <span class="op">&lt;-</span> <span class="fu">COMBO_MCMC</span><span class="op">(</span><span class="va">Ystar</span>, x <span class="op">=</span> <span class="va">x_matrix</span>, z <span class="op">=</span> <span class="va">z_matrix</span>,</span></span>
<span class="r-in"><span>                           prior <span class="op">=</span> <span class="st">"uniform"</span>,</span></span>
<span class="r-in"><span>                           beta_prior_parameters <span class="op">=</span> <span class="va">beta_prior_parameters</span>,</span></span>
<span class="r-in"><span>                           gamma_prior_parameters <span class="op">=</span> <span class="va">gamma_prior_parameters</span>,</span></span>
<span class="r-in"><span>                           number_MCMC_chains <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                           MCMC_sample <span class="op">=</span> <span class="fl">200</span>, burn_in <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compiling model graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Resolving undeclared variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Allocating nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Graph information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Observed stochastic nodes: 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Unobserved stochastic nodes: 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Total graph size: 35030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compiling model graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Resolving undeclared variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Allocating nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Graph information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Observed stochastic nodes: 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Unobserved stochastic nodes: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Total graph size: 12013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">MCMC_results</span><span class="op">$</span><span class="va">posterior_means_df</span><span class="co"># }</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parameter_name posterior_mean posterior_median</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> beta[1,1]              0.946            0.914 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> beta[1,2]             -<span style="color: #BB0000;">2.29</span>            -<span style="color: #BB0000;">2.23</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> gamma[1,1,1]           0.545            0.550 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> gamma[1,2,1]          -<span style="color: #BB0000;">0.054</span><span style="color: #BB0000; text-decoration: underline;">9</span>          -<span style="color: #BB0000;">0.066</span><span style="color: #BB0000; text-decoration: underline;">4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> gamma[1,1,2]           1.07             1.06  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> gamma[1,2,2]          -<span style="color: #BB0000;">1.62</span>            -<span style="color: #BB0000;">1.56</span>  </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kimberly Hochstedler Webb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

